import{H as w}from"./HeaderComponent-ovXlqhDB.js";import{L}from"./LoadingComponent-bRK5ChZG.js";import{F as $}from"./FooterComponent-7weYKEiE.js";import{P as S}from"./ProductCard-KDj37gOJ.js";import{_ as P,f as n,j as l,m as t,y,F as f,k as x,t as k,e as u,u as d,i as C,g as q,v as A,s as _}from"./index-Ooy_6cGs.js";import"./FixedIcon-Vgr3xHIH.js";const F={props:{pagination:{type:Object,default(){return{has_next:!1,current_page:1,total_pages:1,has_pre:!1}}}},emits:["page"]},V={class:"pagination justify-content-center align-items-center"},B=t("span",{"aria-hidden":"true"},"«",-1),j=[B],E=["onClick"],H=t("span",{"aria-hidden":"true"},"»",-1),z=[H];function T(a,e,s,h,c,o){return n(),l("ul",V,[t("li",{class:y(["page-item mx-1",s.pagination.has_pre?"d-block":"d-none"])},[t("button",{class:"page-link rounded-circle",type:"button","aria-label":"Previous",onClick:e[0]||(e[0]=i=>a.$emit("page",s.pagination.current_page-1))},j)],2),(n(!0),l(f,null,x(s.pagination.total_pages,i=>(n(),l("li",{class:y(["page-item mx-1",s.pagination.current_page===i?"active":""]),key:"page"+i},[t("button",{class:"page-link rounded-circle",href:"#",onClick:p=>a.$emit("page",i)},k(i),9,E)],2))),128)),t("li",{class:y(["page-item mx-1",s.pagination.has_next?"d-block":"d-none"])},[t("button",{class:"page-link rounded-circle",type:"button","aria-label":"Next",onClick:e[1]||(e[1]=i=>a.$emit("page",s.pagination.current_page+1))},z)],2)])}const D=P(F,[["render",T]]),G={components:{HeaderComponent:w,ProductCard:S,LoadingComponent:L,FooterComponent:$,PageComponent:D},data(){return{isLoading:!1,products:[],categories:[{name:"men",childNodes:[]},{name:"female",childNodes:[]},{name:"baby",childNodes:[]}],pagination:[],isPageState:!1,AllProducts:[]}},inject:["toast"],methods:{async getCategories(){await this.axios.get(`
      https://vue3-course-api.hexschool.io//v2/api/rongapi/products/all
      `).then(e=>{e.data.success?(this.AllProducts=e.data.products,e.data.products.forEach(s=>{const h=s.category.split(","),c=h.filter(o=>o.match(/[a-zA-Z]/));this.categories.forEach((o,i)=>{if(o.name===c[0]){const p=h.filter(g=>g.match(/[\u4e00-\u9fa5]/));this.categories[i].childNodes.findIndex(g=>g===p[0])===-1&&this.categories[i].childNodes.push(p[0])}})})):this.toast("error","尚未抓到資料")}).catch(e=>{this.toast("error","尚未抓到資料"),console.error("getCategories error",e)})},async getProducts(a=1){this.isPageState=!0,this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io//v2/api/rongapi/products/?page=${a}`;await this.axios.get(e).then(s=>{s.data.success?(this.products=s.data.products,this.pagination=s.data.pagination):this.toast("error","尚未抓到資料"),this.isLoading=!1}).catch(s=>{this.toast("error","尚未抓到資料"),console.error("products-getProducts error",s),this.isLoading=!1})},async getCategoriesProducts(){this.isPageState=!1,this.isLoading=!0,await this.axios.get(`
      https://vue3-course-api.hexschool.io//v2/api/rongapi/products/all
      `).then(e=>{e.data.success?this.products=e.data.products.filter(s=>s.category.match(this.$route.query.categoryName)).filter(s=>s.category.match(this.$route.query.tabName)):this.toast("error","尚未抓到資料"),this.isLoading=!1}).catch(e=>{this.toast("error","尚未抓到資料"),console.error("getgetCategoriesProducts error",e),this.isLoading=!1})},searchSubmit(){const a=this.$refs.search.value;if(a==="")this.toast("error","未輸入關鍵字");else{this.isPageState=!1;let e=null;e=this.AllProducts.filter(s=>s.title.match(a)),e.length===0&&(e=this.AllProducts.filter(s=>s.category.match(a))),e.length>=1?this.products=e:this.toast("error","未找到商品")}}},created(){this.getCategories(),this.$route.query.categoryName?this.getCategoriesProducts():this.getProducts()}},I=t("input",{type:"checkbox",id:"menu",class:"d-none"},null,-1),O={class:"d-flex aside","data-custom":"menu"},Z={class:"aside-body p-4 bg-body overflow-auto scroll-primary"},J=t("h6",{class:"aside-title ff-serif mb-0 mb-lg-2 text-uppercase"},"TAGS",-1),K={class:"nav pt-12 overflow-auto scrollBar-transparent flex-column"},M={class:"nav-item"},Q={class:"nav-item"},R=["data-bs-target"],U=t("span",{class:"material-symbols-outlined fs-6"}," arrow_drop_down",-1),W=["id"],X={class:"list-group list-group-flush"},Y={class:"list-group-item border-0 px-0"},tt=t("div",{class:"aside-body p-2 d-flex"},[t("label",{for:"menu",class:"writing-mode-vertical text-center menu"},[t("span",{class:"material-symbols-outlined text-primary active"}," keyboard_double_arrow_up "),t("span",{class:"material-symbols-outlined text-primary"}," close ")])],-1),et={class:"has-header-layout"},st={class:"container text-center"},ot={class:"py-40 py-lg-80"},at=t("h2",{class:"text-primary lh-lg m-0 pb-4 ff-serif text-uppercase"}," products ",-1),it={class:"input-group m-auto mb-5 max-width-450"},rt={type:"text",class:"form-control",placeholder:"請輸入關鍵字",ref:"search"},nt=t("span",{class:"material-symbols-outlined fs-5"},"search",-1),ct=[nt];function lt(a,e,s,h,c,o){const i=u("HeaderComponent"),p=u("LoadingComponent"),m=u("router-link"),g=u("ProductCard"),v=u("PageComponent"),N=u("FooterComponent");return n(),l(f,null,[d(i),d(p,{isLoading:c.isLoading},null,8,["isLoading"]),I,t("aside",O,[t("div",Z,[J,t("ul",K,[t("li",M,[t("button",{type:"button",class:"nav-link ls px-0 fw-bold text-uppercase",onClick:e[0]||(e[0]=(...r)=>o.getProducts&&o.getProducts(...r))}," 全部 ")]),t("li",Q,[d(m,{class:"nav-link ls px-0 fw-bold text-uppercase",to:{query:{categoryName:"新品"}},onClick:o.getCategoriesProducts},{default:C(()=>[_(" 新品 ")]),_:1},8,["onClick"])]),(n(!0),l(f,null,x(c.categories,r=>(n(),l("li",{class:"nav-item",key:r.name},[t("button",{type:"button",class:"nav-link ls px-0 fw-bold text-uppercase d-flex align-items-center","data-bs-toggle":"collapse","data-bs-target":`#${r.name}`},[_(k(r.name),1),U],8,R),t("div",{class:"collapse",id:r.name},[t("ul",X,[t("li",Y,[d(m,{class:"border-0 ls bg-transparent p-0 text-uppercase",to:{query:{categoryName:r.name}},onClick:o.getCategoriesProducts},{default:C(()=>[_(" -全部 ")]),_:2},1032,["to","onClick"])]),(n(!0),l(f,null,x(r.childNodes,b=>(n(),l("li",{class:"list-group-item border-0 px-0",key:b},[d(m,{class:"border-0 ls bg-transparent p-0 text-uppercase",to:{query:{categoryName:r.name,tabName:b}},onClick:o.getCategoriesProducts},{default:C(()=>[_(" -"+k(b),1)]),_:2},1032,["to","onClick"])]))),128))])],8,W)]))),128))])]),tt]),t("main",et,[t("section",st,[t("div",ot,[at,t("div",it,[t("input",rt,null,512),t("button",{class:"btn btn-primary d-flex",type:"button",onClick:e[1]||(e[1]=(...r)=>o.searchSubmit&&o.searchSubmit(...r))},ct)]),d(g,{products:c.products},null,8,["products"]),c.isPageState?(n(),q(v,{key:0,pagination:c.pagination,onPage:o.getProducts},null,8,["pagination","onPage"])):A("",!0)])])]),d(N)],64)}const _t=P(G,[["render",lt]]);export{_t as default};
