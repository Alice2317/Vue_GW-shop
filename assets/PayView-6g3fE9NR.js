import{H as w}from"./HeaderComponent-8IuSVmBz.js";import{L}from"./LoadingComponent-TT3uClr5.js";import{_ as k,e as n,f as p,j as h,u as o,m as e,i as f,F as b,y as m,k as C,t as S,z as j,A,s as u}from"./index-yjNCV7Si.js";const F=["臺北市","基隆市","新北市","新竹市","新竹縣","桃園市","宜蘭縣","連江縣","釣魚臺","苗栗縣","臺中市","彰化縣","南投縣","嘉義市","嘉義縣","雲林縣","臺南市","高雄市","南海島","澎湖縣","金門縣","屏東縣","臺東縣","花蓮縣"],I={components:{HeaderComponent:w,LoadingComponent:L},data(){return{isLoading:!1,user:{},carts:[],total:0,finalTotal:0,city:F,county:"",cityAddress:"",message:""}},inject:["toast"],methods:{isPhone(l){return/^(09)[0-9]{8}$/.test(l)?!0:"需要正確的電話號碼"},paySubmit(l){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io//v2/api/rongapi/order",i=this.user,g=this.address;this.axios.post(t,{data:{user:{...i,address:g},message:this.message}}).then(s=>{s.data.success?this.pay(s.data.orderId):this.toast("error","失敗，請重新操作")}).catch(s=>{this.toast("error","失敗，請重新操作"),console.error("pay-paySubmit error",s)})},pay(l){const t=`https://vue3-course-api.hexschool.io//v2/api/rongapi/pay/${l}`;this.axios.post(t).then(i=>{i.data.success?(this.toast("success","交易成功，正在跳轉至交易明細頁面"),this.$router.push({name:"trade",params:{orderId:l}}),this.user={name:"",email:"",tel:"",address:""},this.message=""):this.toast("error","失敗，交易失敗"),this.isLoading=!1}).catch(i=>{this.toast("error","失敗，交易失敗"),console.error("pay-pay error",i),this.isLoading=!1})}},computed:{address(){return`${this.county}${this.cityAddress}`}},mounted(){this.carts=localStorage.getItem("carts"),this.finalTotal=localStorage.getItem("finalTotal"),this.total=localStorage.getItem("total")}},U={class:"has-header-layout"},E={class:"container"},N={class:"py-80 py-40 max-width-600 m-auto"},T=e("div",{class:"min-height-120"},[e("div",{class:"mx-40 position-relative"},[e("div",{class:"progress",style:{height:"1px"}},[e("div",{class:"progress-bar",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"})]),e("div",{class:"d-flex flex-column align-items-center position-absolute top-0 start-0 translate-middle mt-28"},[e("p",{class:"bg-gray width-32 height-32 rounded-circle text-light d-flex justify-content-center align-items-center"},[e("span",{class:"material-symbols-outlined fs-6"}," done ")]),e("p",{class:"text-nowrap opacity-75"},"確認訂單")]),e("div",{class:"d-flex flex-column align-items-center position-absolute top-0 start-50 translate-middle mt-28"},[e("p",{class:"bg-primary width-32 height-32 rounded-circle text-light d-flex justify-content-center align-items-center"}," 2 "),e("p",{class:"text-nowrap"},"填寫資料")]),e("div",{class:"d-flex flex-column align-items-center position-absolute top-0 start-100 translate-middle mt-28"},[e("p",{class:"bg-gray width-32 height-32 rounded-circle text-light d-flex justify-content-center align-items-center"},"3"),e("p",{class:"text-nowrap opacity-75"},"交易結果")])])],-1),q={class:"mb-4"},H=e("label",{for:"name",class:"form-label"},[u("姓名"),e("span",{class:"text-danger"},"*")],-1),M={class:"mb-4"},B=e("label",{for:"email",class:"form-label"},[u("Email"),e("span",{class:"text-danger"},"*")],-1),P={class:"mb-4"},z=e("label",{for:"tel",class:"form-label"},[u("電話"),e("span",{class:"text-danger"},"*")],-1),D={class:"mb-4"},G=e("label",{for:"county",class:"form-label"},[u("地址"),e("span",{class:"text-danger"},"*")],-1),J={class:"address-inputGroup"},K=e("option",{selected:"",disabled:"",value:""},"請選擇縣市",-1),O=["value"],Q={class:"mb-4"},R=e("label",{for:"message",class:"form-label"},"留言",-1),W={class:"d-flex flex-column-reverse flex-md-row align-items-center justify-content-between"},X=e("button",{type:"submit",class:"btn btn-dark"},"付款",-1);function Y(l,t,i,g,s,_){const y=n("HeaderComponent"),v=n("LoadingComponent"),r=n("VField"),d=n("ErrorMessage"),x=n("router-link"),V=n("VForm");return p(),h(b,null,[o(y),o(v,{isLoading:s.isLoading},null,8,["isLoading"]),e("main",U,[e("section",E,[e("div",N,[T,o(V,{onSubmit:_.paySubmit},{default:f(({errors:c})=>[e("div",q,[H,o(r,{id:"name",name:"姓名",type:"text",class:m(["form-control",{"is-invalid":c.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.user.name,"onUpdate:modelValue":t[0]||(t[0]=a=>s.user.name=a)},null,8,["class","modelValue"]),o(d,{class:"invalid-feedback",name:"姓名"})]),e("div",M,[B,o(r,{id:"email",name:"email",type:"email",class:m(["form-control",{"is-invalid":c.email}]),placeholder:"請輸入EMAIL",rules:"email|required",modelValue:s.user.email,"onUpdate:modelValue":t[1]||(t[1]=a=>s.user.email=a)},null,8,["class","modelValue"]),o(d,{class:"invalid-feedback",name:"email"})]),e("div",P,[z,o(r,{id:"tel",name:"電話",type:"tel",class:m(["form-control",{"is-invalid":c.電話}]),placeholder:"請輸入電話",rules:_.isPhone,modelValue:s.user.tel,"onUpdate:modelValue":t[2]||(t[2]=a=>s.user.tel=a)},null,8,["class","rules","modelValue"]),o(d,{class:"invalid-feedback",name:"電話"})]),e("div",D,[G,e("div",J,[o(r,{id:"county",name:"縣市",class:m(["form-control input-address",{"is-invalid":c.縣市}]),placeholder:"請選擇縣市",rules:"required",modelValue:s.county,"onUpdate:modelValue":t[3]||(t[3]=a=>s.county=a),as:"select"},{default:f(()=>[K,(p(!0),h(b,null,C(s.city,a=>(p(),h("option",{key:a,value:a},S(a),9,O))),128))]),_:2},1032,["class","modelValue"]),o(r,{name:"地址",class:m(["form-control input-address border-start-0",{"is-invalid":c.地址}]),placeholder:"請輸入地址",modelValue:s.cityAddress,"onUpdate:modelValue":t[4]||(t[4]=a=>s.cityAddress=a),rules:"required"},null,8,["class","modelValue"]),o(d,{class:"invalid-feedback error-address",name:"縣市"}),o(d,{class:"invalid-feedback error-address",name:"地址"})])]),e("div",Q,[R,j(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=a=>s.message=a)},null,512),[[A,s.message]])]),e("div",W,[o(x,{class:"pt-3 pt-md-0",to:{name:"cart"}},{default:f(()=>[u(" 上一步 ")]),_:1}),X])]),_:1},8,["onSubmit"])])])])],64)}const se=k(I,[["render",Y]]);export{se as default};
